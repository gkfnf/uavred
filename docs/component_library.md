# 可复用组件库规范

## 概述

本文档定义了 UAVRED 应用中所有可复用组件的设计规范和使用方式。所有组件都遵循 ui_design.md 中定义的设计原则。

---

## 1. 基础组件

### 1.1 Button (按钮)

**用途**: 触发操作

**变体**:

#### Primary Button (主按钮)
```
┌─────────────────┐
│ 启动扫描          │
└─────────────────┘
背景: #a78bfa (紫色)
文字: 白色
高度: 36px
```

#### Secondary Button (次按钮)
```
┌─────────────────┐
│ 预览              │
└─────────────────┘
背景: transparent
边框: #2d2d2d
文字: 白色
高度: 36px
```

#### Danger Button (危险按钮)
```
┌─────────────────┐
│ 删除              │
└─────────────────┘
背景: #ef4444 (红色)
文字: 白色
高度: 36px
```

#### Icon Button (图标按钮)
```
┌────┐
│ ⚙️ │
└────┘
大小: 32x32px
背景: transparent (Hover 时 #252525)
```

**属性**:
- 圆角: 6px
- 字体: Medium 12px
- 内边距: 8px 16px
- 过渡: 200ms

**状态**:
- Normal: 标准样式
- Hover: 亮度 +5%
- Active: 亮度 +10%
- Disabled: 透明度 50%

---

### 1.2 Input (输入框)

**用途**: 文字输入

```
┌─────────────────────────────────┐
│ 🔍 Search devices...            │
└─────────────────────────────────┘
```

**属性**:
- 高度: 36px
- 背景: #252525
- 边框: 1px solid #2d2d2d
- 圆角: 6px
- 内边距: 8px 12px
- 文字颜色: 白色
- Placeholder: 灰色 (#808080)

**状态**:
- Focused: 边框 #a78bfa
- Error: 边框 #ef4444
- Disabled: 背景 #1e1e1e, 文字灰色

---

### 1.3 Badge (徽章)

**用途**: 显示计数、标签、状态

#### Count Badge (计数徽章)
```
┌────┐
│ 12 │
└────┘
背景: #ef4444 (红色)
文字: 白色
大小: 20x20px
圆角: 50% (圆形)
```

#### Status Badge (状态徽章)
```
┌──────────┐
│ SCANNING │
└──────────┘
背景: #fbbf24 (黄色)
文字: 黑色
高度: 20px
圆角: 4px
内边距: 4px 8px
```

#### Priority Badge (优先级徽章)
```
critical  → 红色 #ef4444
high      → 橙色 #f97316
medium    → 黄色 #fbbf24
low       → 蓝色 #60a5fa
```

---

### 1.4 Tag (标签)

**用途**: 分类标签、技能标签

```
┌─────────┐
│ MAVLink │
└─────────┘
背景: #252525
边框: 1px solid #a78bfa
文字: #a78bfa
高度: 24px
圆角: 4px
内边距: 4px 8px
```

**变体**:
- 可移除 Tag: 右侧 ✕ 按钮
- 可选择 Tag: Checkbox

---

### 1.5 Checkbox (复选框)

**用途**: 多选

```
☐ Option 1
☑ Option 2 (selected)
```

**大小**: 16x16px
**颜色**: 选中时 #a78bfa

---

### 1.6 Radio Button (单选框)

**用途**: 单选

```
○ Option 1
● Option 2 (selected)
```

**大小**: 16x16px
**颜色**: 选中时 #a78bfa

---

### 1.7 Toggle (切换开关)

**用途**: 二元开关

```
OFF:  ◯─  (背景灰色 #404040)
ON:   ─◯  (背景绿色 #10b981)
```

**大小**: 44x24px
**动画**: 200ms 平滑过渡

---

### 1.8 Dropdown (下拉菜单)

**用途**: 选择列表

```
┌──────────────────────┐
│ Select Protocol ▼    │
└──────────────────────┘

↓ (打开)

┌──────────────────────┐
│ MAVLink              │
│ DJI                  │
│ ArduPilot            │
│ PX4                  │
└──────────────────────┘
```

**属性**:
- 菜单项高度: 36px
- 最大显示项数: 6 (需要滚动)
- 背景: #252525
- Hover 项: 背景 #2d2d2d

---

### 1.9 Alert (警告框)

**用途**: 展示重要信息

#### Success Alert
```
┌──────────────────────────┐
│ ✓ 扫描已启动             │
└──────────────────────────┘
背景: #10b981 (30% 透明度)
边框: 1px solid #10b981
文字: #10b981
```

#### Error Alert
```
┌──────────────────────────┐
│ ✗ 连接失败                │
└──────────────────────────┘
背景: #ef4444 (30% 透明度)
边框: 1px solid #ef4444
文字: #ef4444
```

#### Warning Alert
```
┌──────────────────────────┐
│ ⚠ 需要授权               │
└──────────────────────────┘
背景: #fbbf24 (30% 透明度)
边框: 1px solid #fbbf24
文字: #000000
```

#### Info Alert
```
┌──────────────────────────┐
│ ⓘ 扫描正在进行           │
└──────────────────────────┘
背景: #60a5fa (30% 透明度)
边框: 1px solid #60a5fa
文字: #60a5fa
```

**属性**:
- 圆角: 6px
- 内边距: 12px 16px
- 高度: 40px
- 关闭按钮: 可选

---

## 2. 容器组件

### 2.1 Card (卡片)

**用途**: 分组相关内容

```
┌──────────────────────────┐
│ 标题                      │
│                          │
│ 卡片内容                  │
│                          │
└──────────────────────────┘
```

**属性**:
- 背景: #252525
- 边框: 1px solid #2d2d2d
- 圆角: 8px
- 内边距: 16px
- 阴影: rgba(0,0,0,0.3)

**变体**:
- Elevated Card: 提升阴影
- Outlined Card: 只有边框

---

### 2.2 Panel (面板)

**用途**: 大内容区域

**属性**:
- 背景: #252525
- 边框: 1px solid #2d2d2d
- 圆角: 8px
- 内边距: 20px
- 最小高度: 300px

---

### 2.3 Tab (标签页)

**用途**: 多视图切换

```
[Dashboard] [Assets] [Scan] [Findings]
├─────────────────────────────────────
│ 标签页内容
└─────────────────────────────────────
```

**属性**:
- 标签高度: 40px
- 字体: 13px
- 选中态: 紫色 (#a78bfa) 下划线
- 非选中: 灰色文字

**交互**:
- 点击切换标签
- 支持键盘导航 (← →)

---

### 2.4 Modal (模态框)

**用途**: 重要操作确认

```
╔════════════════════════════╗
║ 确认删除                    ║
╠════════════════════════════╣
║ 确定要删除此任务吗？        ║
║                            ║
║ [取消] [删除]              ║
╚════════════════════════════╝
```

**属性**:
- 背景: #252525
- 边框: 1px solid #2d2d2d
- 圆角: 8px
- 阴影: rgba(0,0,0,0.8)
- 宽度: 400-600px

**层级**:
- Overlay: 黑色 (80% 透明度)
- 动画: 淡入 200ms

---

### 2.5 Drawer (抽屉)

**用途**: 侧边面板

```
主内容 │ ╔════════════╗
       │ ║ 详情面板    ║
       │ ║            ║
       │ ║            ║
       │ ╚════════════╝
```

**属性**:
- 位置: 右侧（默认）
- 宽度: 350px
- 背景: #1e1e1e
- 动画: 滑入 300ms
- Z-index: 高于主内容

---

## 3. 列表组件

### 3.1 ListItem (列表项)

**用途**: 列表行

```
┌──────────────────────────────────────┐
│ ●  Item Title            Secondary   │
│    Subtitle text                     │
└──────────────────────────────────────┘
```

**属性**:
- 高度: 60-80px
- 背景: transparent
- Hover: 背景 #252525
- Divider: #2d2d2d, 1px

---

### 3.2 Table (表格)

**用途**: 数据表格

```
┌────┬──────────┬────────┬───────┐
│ ID │ Device   │ Status │ Time  │
├────┼──────────┼────────┼───────┤
│ 1  │ mavic-3  │ 🟢 On  │ 10:30 │
│ 2  │ phantom  │ 🔴 Off │ 10:15 │
└────┴──────────┴────────┴───────┘
```

**属性**:
- 表头背景: #2d2d2d
- 行高: 40px
- 行间线: 1px #2d2d2d
- 字体大小: 12px

---

### 3.3 VirtualList (虚拟列表)

**用途**: 大数据列表优化

**属性**:
- 适用于 >100 项列表
- 动态渲染可见区域
- 滚动性能: 60fps

---

## 4. 表单组件

### 4.1 FormField (表单字段)

**用途**: 表单控制

```
┌─────────────────┐
│ 标签 *          │
│ [Input]         │
│ 帮助文字          │
└─────────────────┘
```

**属性**:
- 标签字体: Bold 12px
- 字段底部间距: 16px
- 错误消息: 红色 #ef4444
- 必填标记: 红色 *

---

### 4.2 Select (选择器)

**用途**: 从列表中选择

```
┌──────────────┐
│ Select ▼     │
└──────────────┘
```

**行为**:
- 单选或多选
- 支持搜索
- 显示选中标记

---

### 4.3 DatePicker (日期选择器)

**用途**: 日期输入

```
┌──────────────────┐
│ 2024-12-31 ▼    │
└──────────────────┘

(点击展开日历)
```

---

### 4.4 TimePicker (时间选择器)

**用途**: 时间输入

```
┌──────────────────┐
│ 14:30:45 ▼      │
└──────────────────┘
```

---

## 5. 数据展示组件

### 5.1 Progress Bar (进度条)

**用途**: 显示进度

```
[████████░░░░░░░░░░░░░░░░] 33%
```

**属性**:
- 高度: 8px
- 背景: #2d2d2d
- 填充: #a78bfa
- 圆角: 4px

---

### 5.2 Spinner (加载动画)

**用途**: 加载状态

```
⏳ 加载中...
```

或使用旋转圆形动画。

---

### 5.3 Skeleton (骨架屏)

**用途**: 内容加载中占位符

```
┌─────────────────┐
│ ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ │ (灰色占位符)
│ ▒▒▒▒▒▒▒▒▒▒▒▒▒▒▒ │
│ ▒▒▒▒▒▒░░░░▒▒▒▒▒ │
└─────────────────┘
```

---

### 5.4 Empty State (空状态)

**用途**: 无内容提示

```
┌─────────────────┐
│                 │
│      📭         │
│                 │
│  没有发现任何   │
│                 │
│ [新建] [导入]    │
└─────────────────┘
```

---

### 5.5 Toast (通知)

**用途**: 临时消息

```
┌──────────────────────────┐
│ ✓ 操作成功 (2s 后消失)    │
└──────────────────────────┘
```

**位置**: 右下角
**显示时间**: 2-4 秒
**优先级**: Stack 最多 3 条

---

### 5.6 Tooltip (气泡提示)

**用途**: 悬停帮助信息

```
      ┌──────────┐
      │ 帮助文字   │
      └──────────┘
         △
      [Icon]
```

**延迟**: 500ms 显示
**宽度**: 最多 250px

---

## 6. 专业组件

### 6.1 TaskCard (任务卡片)

见 ui_design.md 第 3.2 节

**属性**:
- 宽度: 100%（列内）
- 高度: 80-120px
- 样式: 见详细设计

---

### 6.2 FindingItem (发现项)

见 ui_design.md 第 3.3 节

**属性**:
- 宽度: 100%
- 高度: 100-120px
- 可点击打开详情

---

### 6.3 AgentLog (Agent 日志)

见 ui_design.md 第 3.7 节

**属性**:
- 单行高: 18px
- 等宽字体
- 颜色编码: 见详细设计

---

### 6.4 KanbanBoard (Kanban 看板)

见 ui_design.md 第 3.2 节

**功能**:
- 三列布局
- 拖拽支持
- 响应式

---

## 7. 组件使用示例

### 示例 1: 创建按钮

```rust
Button::new("启动扫描")
    .variant(ButtonVariant::Primary)
    .size(ButtonSize::Medium)
    .on_click(on_start_scan)
```

### 示例 2: 创建输入框

```rust
TextInput::new("Search devices...")
    .placeholder_text("请输入设备名称")
    .on_change(on_search_change)
    .icon(Icon::Search)
```

### 示例 3: 创建卡片

```rust
Card::new(
    Column::new()
        .push(Text::new("标题"))
        .push(Text::new("内容"))
)
.on_click(on_card_click)
```

---

## 8. 组件间距指南

使用统一的间距系统：

```rust
const GAP_1: f32 = 4.0;   // 组件内部
const GAP_2: f32 = 8.0;   // 相邻元素
const GAP_3: f32 = 12.0;  // 组件间距
const GAP_4: f32 = 16.0;  // 分组间距
const GAP_5: f32 = 24.0;  // 区域间距
```

---

## 9. 颜色使用指南

| 用途 | 颜色 | 十六进制 | 说明 |
|------|------|---------|------|
| 成功 | 绿色 | #10b981 | 完成、正常状态 |
| 警告 | 黄色 | #fbbf24 | 注意、进行中 |
| 错误 | 红色 | #ef4444 | 失败、危险 |
| 信息 | 蓝色 | #60a5fa | 中立、提示 |
| 强调 | 紫色 | #a78bfa | 重要、交互 |
| 次强调 | 橙色 | #f97316 | 次要强调 |

---

## 10. 暗模式下的组件

所有组件都基于深色背景设计：

- 文字使用白色或浅灰色
- 背景使用 #1e1e1e 到 #2d2d2d
- 边框使用深灰色 #2d2d2d
- 阴影使用黑色 (50% 透明度)

---

## 11. 组件可访问性

所有组件应满足：

- **WCAG 2.1 AA 标准**
- **键盘导航**: Tab 键可访问所有交互元素
- **屏幕阅读器**: 有意义的 ARIA label
- **焦点指示**: 清晰的焦点样式

---

## 12. 组件状态矩阵

| 组件 | Normal | Hover | Active | Disabled | Loading |
|------|--------|-------|--------|----------|---------|
| Button | ✓ | ✓ | ✓ | ✓ | ✓ |
| Input | ✓ | ✓ | ✓ | ✓ | - |
| Card | ✓ | ✓ | - | - | - |
| Tab | ✓ | ✓ | ✓ | ✓ | - |
| Checkbox | ✓ | ✓ | ✓ | ✓ | - |

---

## 附录：组件库文件结构

```
src/ui/components/
├── mod.rs              # 导出所有组件
├── button.rs           # Button 组件
├── input.rs            # Input 组件
├── badge.rs            # Badge 组件
├── tag.rs              # Tag 组件
├── card.rs             # Card 组件
├── modal.rs            # Modal 组件
├── alert.rs            # Alert 组件
├── task_card.rs        # TaskCard 组件
├── finding_item.rs     # FindingItem 组件
├── agent_log.rs        # AgentLog 组件
└── styles.rs           # 全局样式常量
```

