# UI Agent 规则手册（可复制到 prompt）

### 1) 输出物要求（每次 UI 变更都要交付）

- **一段话说明**：你改了什么、为什么。
- **可截图的交互路径**：从 Nav 进入 → 操作 → 看到结果（写成 3–6 步）。
- **状态与错误态**：至少说明 1 个失败场景怎么展示与如何恢复。

---

### 2) 禁止事项（硬规则）

- **禁止**在 `render()` 里堆超长链式 UI 不抽组件（超过 ~120 行必须拆分）。
- **禁止**业务逻辑（状态变更、运行编排、评分计算）写进渲染函数；必须通过 action/event 边界。
- **禁止**用颜色表达无语义信息；风险色/状态色必须全局一致。
- **禁止**隐藏危险操作后果；必须有范围提示与确认。

---

### 3) 组件与样式规则

- **优先复用**：`AppShell / Kanban* / InspectorPanel / StatusPill / Tag / ConfirmDialog / EventStreamView / ArtifactList / RiskBreakdown`
- **一致的密度**：卡片与列表行保持统一 padding、字体等级、hover/selected 样式。
- **文本优先**：高密度工具 UI，图标只辅助定位，不替代文本。

---

### 4) 交互规则（红队工作台）

- **默认视图 = 工作流**：用户打开就能“投递意图 → 看到计划 → 开跑 → 看到证据/风险”。
- **所有执行都可停止**：Running 状态必须有 Stop，并显示“停止会发生什么”（清理容器/保留证据等）。
- **事件流必须结构化**：至少包含 timestamp、level、source(agent)、subject(asset)、message。

---

### 5) PR Checklist（UI）

- **布局**：窗口缩放到 1200×800 与更小尺寸时可用（不遮挡关键按钮）。
- **性能**：日志/事件流追加 10k 行仍可滚动（至少做到过滤/折叠/分页之一）。
- **可用性**：键盘能完成核心路径（Command Palette / 搜索 / 切换卡片 / 打开 Inspector）。
- **风险提示**：危险操作必须两段式确认 + 显示范围。

---

### 6) 可直接给 UI agent 的提示词模板

将下面模板粘贴给 agent，并替换方括号内容：

> 你是一个 Rust gpui UI 工程师。请严格遵循 `docs/ui/BLUEPRINT.md` 与本规则手册。  
> 任务：实现/修改界面 [页面/组件名]，目标是让用户在 [场景] 下完成 [动作] 并在 Inspector 中看到 [证据/状态/风险]。  
> 约束：不得把业务逻辑写进 render；新增 UI 需抽成可复用组件；必须包含 loading/error/empty 三态；危险操作需确认并显示资产范围。  
> 交付：给出涉及文件列表 + 关键组件结构 + 交互步骤（3–6 步）+ 错误态说明。


